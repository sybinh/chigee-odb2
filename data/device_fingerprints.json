{
  "database_version": "1.0",
  "last_updated": "2025-09-14",
  "description": "Database of known working OBD2 devices with Chigee XR2",
  "devices": {
    "genuine_elm327_v15": {
      "device_info": {
        "name": "ELM327 v1.5 (Genuine)",
        "manufacturer": "ELM Electronics",
        "firmware": "ELM327 v1.5",
        "chip": "ELM327",
        "verified_working": true,
        "compatibility_rating": 5
      },
      "bluetooth_characteristics": {
        "typical_mac_prefixes": ["00:1B:DC", "00:0D:18"],
        "device_name_patterns": ["ELM327", "OBDII"],
        "service_uuids": ["00001101-0000-1000-8000-00805F9B34FB"],
        "manufacturer_data": "ELM Electronics"
      },
      "at_command_behavior": {
        "initialization_sequence": [
          "ATZ",
          "ATE0", 
          "ATL0",
          "ATS0",
          "ATH1",
          "ATSP0"
        ],
        "typical_responses": {
          "ATZ": "ELM327 v1.5",
          "ATE0": "OK",
          "ATI": "ELM327 v1.5",
          "AT@1": "ELM327",
          "AT@2": "?",
          "ATDP": "AUTO",
          "ATRV": "12.0V"
        },
        "timing_characteristics": {
          "avg_response_time_ms": 65,
          "min_response_time_ms": 40,
          "max_response_time_ms": 120,
          "initialization_delay_ms": 500
        },
        "error_behaviors": {
          "unknown_command": "?",
          "invalid_pid": "NO DATA",
          "can_error": "BUS ERROR",
          "timeout": "NO DATA"
        }
      },
      "security_features": {
        "authentication_required": false,
        "mac_address_validation": false,
        "firmware_checksum": false,
        "proprietary_commands": []
      }
    },
    "obdlink_mx_plus": {
      "device_info": {
        "name": "OBDLink MX+",
        "manufacturer": "ScanTool.net",
        "firmware": "STN1170 v4.0",
        "chip": "STN1170",
        "verified_working": true,
        "compatibility_rating": 5
      },
      "bluetooth_characteristics": {
        "typical_mac_prefixes": ["00:04:3E"],
        "device_name_patterns": ["OBDLink MX+"],
        "service_uuids": ["00001101-0000-1000-8000-00805F9B34FB"],
        "manufacturer_data": "ScanTool.net"
      },
      "at_command_behavior": {
        "initialization_sequence": [
          "ATZ",
          "ATE0",
          "ATL0", 
          "ATS0",
          "ATH1",
          "ATSP0"
        ],
        "typical_responses": {
          "ATZ": "STN1170 v4.0",
          "ATE0": "OK", 
          "ATI": "STN1170 v4.0",
          "ATSTDI": "STN1170",
          "ATDP": "AUTO",
          "ATRV": "12.1V"
        },
        "timing_characteristics": {
          "avg_response_time_ms": 45,
          "min_response_time_ms": 25,
          "max_response_time_ms": 80,
          "initialization_delay_ms": 300
        },
        "error_behaviors": {
          "unknown_command": "?",
          "invalid_pid": "NO DATA",
          "can_error": "CAN ERROR", 
          "timeout": "NO DATA"
        }
      },
      "security_features": {
        "authentication_required": false,
        "mac_address_validation": false,
        "firmware_checksum": false,
        "proprietary_commands": ["ATSTDI", "ATSTM", "ATSTIN"]
      }
    },
    "cheap_chinese_clone": {
      "device_info": {
        "name": "Generic ELM327 Clone",
        "manufacturer": "Various",
        "firmware": "ELM327 v1.5 (fake)",
        "chip": "Unknown/Clone",
        "verified_working": false,
        "compatibility_rating": 2
      },
      "bluetooth_characteristics": {
        "typical_mac_prefixes": ["AA:BB:CC", "12:34:56"],
        "device_name_patterns": ["OBDII", "ELM327"],
        "service_uuids": ["00001101-0000-1000-8000-00805F9B34FB"],
        "manufacturer_data": "Unknown"
      },
      "at_command_behavior": {
        "initialization_sequence": [
          "ATZ",
          "ATE0"
        ],
        "typical_responses": {
          "ATZ": "ELM327 v1.5",
          "ATE0": "OK",
          "ATI": "ELM327 v1.5",
          "ATRV": "12.0V"
        },
        "timing_characteristics": {
          "avg_response_time_ms": 200,
          "min_response_time_ms": 150,
          "max_response_time_ms": 500,
          "initialization_delay_ms": 1000
        },
        "error_behaviors": {
          "unknown_command": "?",
          "invalid_pid": "NO DATA",
          "can_error": "ERROR",
          "timeout": "ERROR"
        }
      },
      "security_features": {
        "authentication_required": false,
        "mac_address_validation": false,
        "firmware_checksum": false,
        "proprietary_commands": []
      },
      "known_issues": [
        "Slow response times",
        "Limited AT command support",
        "Unreliable CAN communication",
        "May not work with some vehicles"
      ]
    },
    "bafx_products_reader": {
      "device_info": {
        "name": "BAFX Products OBD Reader",
        "manufacturer": "BAFX Products",
        "firmware": "ELM327 v1.5",
        "chip": "ELM327 Compatible",
        "verified_working": true,
        "compatibility_rating": 4
      },
      "bluetooth_characteristics": {
        "typical_mac_prefixes": ["00:0D:18"],
        "device_name_patterns": ["OBDII"],
        "service_uuids": ["00001101-0000-1000-8000-00805F9B34FB"],
        "manufacturer_data": "BAFX"
      },
      "at_command_behavior": {
        "initialization_sequence": [
          "ATZ",
          "ATE0",
          "ATL0",
          "ATS0",
          "ATH1"
        ],
        "typical_responses": {
          "ATZ": "ELM327 v1.5",
          "ATE0": "OK",
          "ATI": "ELM327 v1.5",
          "ATRV": "12.0V"
        },
        "timing_characteristics": {
          "avg_response_time_ms": 80,
          "min_response_time_ms": 50,
          "max_response_time_ms": 150,
          "initialization_delay_ms": 600
        },
        "error_behaviors": {
          "unknown_command": "?",
          "invalid_pid": "NO DATA",
          "can_error": "BUS ERROR",
          "timeout": "NO DATA"
        }
      },
      "security_features": {
        "authentication_required": false,
        "mac_address_validation": false,
        "firmware_checksum": false,
        "proprietary_commands": []
      }
    }
  },
  "chigee_xr2_analysis": {
    "suspected_security_mechanisms": [
      {
        "type": "device_whitelist",
        "description": "Chigee may maintain a whitelist of known good device MAC addresses",
        "evidence": "Some devices connect immediately while others are rejected",
        "bypass_strategy": "Spoof MAC address of known working device"
      },
      {
        "type": "timing_validation", 
        "description": "Response timing may be validated against expected hardware behavior",
        "evidence": "Very fast responses may trigger security warnings",
        "bypass_strategy": "Add realistic delays matching genuine hardware"
      },
      {
        "type": "firmware_fingerprinting",
        "description": "Specific AT command responses may be fingerprinted",
        "evidence": "Different responses to AT@1, AT@2, ATDP commands",
        "bypass_strategy": "Match exact responses from working devices"
      },
      {
        "type": "behavioral_analysis",
        "description": "Command sequence and error patterns may be analyzed",
        "evidence": "Certain command sequences work while others fail",
        "bypass_strategy": "Follow exact initialization sequences of working devices"
      }
    ],
    "recommended_spoofing_targets": [
      {
        "device": "genuine_elm327_v15",
        "priority": 1,
        "reason": "Most widely compatible, standard reference implementation"
      },
      {
        "device": "obdlink_mx_plus", 
        "priority": 2,
        "reason": "Professional grade, likely in Chigee compatibility database"
      },
      {
        "device": "bafx_products_reader",
        "priority": 3,
        "reason": "Popular consumer device, good compatibility"
      }
    ],
    "attack_vectors": [
      {
        "name": "MAC Address Spoofing",
        "difficulty": "Easy",
        "description": "Change ESP32 MAC to match known working device",
        "implementation": "esp_base_mac_addr_set(target_mac)"
      },
      {
        "name": "Response Timing Matching",
        "difficulty": "Medium", 
        "description": "Add delays to match hardware response times",
        "implementation": "delay(target_device.avg_response_time)"
      },
      {
        "name": "Firmware Response Cloning",
        "difficulty": "Medium",
        "description": "Clone exact AT command responses from target device",
        "implementation": "Match all ATI, AT@1, AT@2, ATRV responses exactly"
      },
      {
        "name": "Behavioral Pattern Mimicking",
        "difficulty": "Hard",
        "description": "Replicate exact initialization and command sequences",
        "implementation": "State machine following target device behavior"
      }
    ]
  },
  "reverse_engineering_targets": {
    "priority_commands": [
      "ATZ", "ATI", "AT@1", "AT@2", "ATRV", "ATDP", "ATDPN"
    ],
    "suspicious_responses": [
      "Commands that cause immediate disconnection",
      "Responses that differ significantly from standard ELM327",
      "Timing-sensitive command sequences"
    ],
    "analysis_methodology": [
      "Capture traffic from multiple known working devices",
      "Compare initialization sequences and command responses",
      "Identify device-specific fingerprints and patterns",
      "Test edge cases and error conditions",
      "Analyze disconnection triggers and security failures"
    ]
  }
}