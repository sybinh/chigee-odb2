; ===================================================================
; PlatformIO Project Configuration File for Chigee OBD2 Module
; Professional ESP32 Development Environment - FIXED VERSION
; ===================================================================

[platformio]
default_envs = esp32_production

; ===== PRODUCTION ENVIRONMENT =====
[env:esp32_production]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags = -DCORE_DEBUG_LEVEL=3

; Source file for production
build_src_filter = 
    +<main.cpp>
    +<modules/>
    +<config/>
    -<test_main.cpp>
    -<test_simple.cpp>
    -<test_elm327.cpp>
    -<bluetooth_scanner.cpp>
    -<simple_scanner.cpp>
    -<tests/>

; ===== ELM327 COMPATIBILITY TEST =====
[env:esp32_elm327_test]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags = -DCORE_DEBUG_LEVEL=3

; ELM327 compatibility test
build_src_filter = 
    +<test_elm327.cpp>
    -<main.cpp>
    -<test_main.cpp>
    -<test_simple.cpp>
    -<bluetooth_scanner.cpp>
    -<simple_scanner.cpp>
    -<modules/>
    -<config/>
    -<tests/>

; ===== SIMPLE SCANNER ENVIRONMENT =====
[env:esp32_simple_scanner]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags = -DCORE_DEBUG_LEVEL=3

; Simple Bluetooth scanner
build_src_filter = 
    +<simple_scanner.cpp>
    -<main.cpp>
    -<test_main.cpp>
    -<test_simple.cpp>
    -<test_elm327.cpp>
    -<bluetooth_scanner.cpp>
    -<modules/>
    -<config/>
    -<tests/>

; ===== SHARED CONFIGURATION =====
[env]
; Upload configuration
monitor_speed = 115200
upload_speed = 921600
upload_port = COM*

; Build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DARDUINO_RUNNING_CORE=1
    -DARDUINO_EVENT_RUNNING_CORE=1
    -DPROJECT_VERSION=\"3.0.0\"
    -DENABLE_DEBUG_OUTPUT=1
    -DESP32_WROOM_32=1
    
; ===== LIBRARY DEPENDENCIES =====
lib_deps = 
    ESP32 BLE Arduino
    Preferences
    BluetoothSerial